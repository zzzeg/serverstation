{"version":3,"sources":["uni-app:///main.js","webpack:///E:/yisheng_mingwo/serverMobile/trunk/pages/authoritative/consultDetails.vue?8d56","webpack:///E:/yisheng_mingwo/serverMobile/trunk/pages/authoritative/consultDetails.vue?4147","webpack:///E:/yisheng_mingwo/serverMobile/trunk/pages/authoritative/consultDetails.vue?b223","webpack:///E:/yisheng_mingwo/serverMobile/trunk/pages/authoritative/consultDetails.vue?0c5f","uni-app:///pages/authoritative/consultDetails.vue","webpack:///E:/yisheng_mingwo/serverMobile/trunk/pages/authoritative/consultDetails.vue?0f00"],"names":["createPage","Page","renderjs","component","options","__file","components","xyDialog","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped"],"mappings":"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","file":"pages/authoritative/consultDetails.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/authoritative/consultDetails.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./consultDetails.vue?vue&type=template&id=ecbb24f4&\"\nvar renderjs\nimport script from \"./consultDetails.vue?vue&type=script&lang=js&\"\nexport * from \"./consultDetails.vue?vue&type=script&lang=js&\"\nimport style0 from \"./consultDetails.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"E:/yisheng_mingwo/serverMobile/trunk/pages/authoritative/consultDetails.vue\"\nexport default component.exports","export * from \"-!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./consultDetails.vue?vue&type=template&id=ecbb24f4&\"","var components = {\n  xyDialog: function() {\n    return import(\n      /* webpackChunkName: \"components/xy-dialog/xy-dialog\" */ \"@/components/xy-dialog/xy-dialog.vue\"\n    )\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./consultDetails.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./consultDetails.vue?vue&type=script&lang=js&\"","<template>\n    <view >\n        <view class=\"content\" @touchstart=\"hideDrawer\">\n            <scroll-view class=\"msg-list\" scroll-y=\"true\" :show-scrollbar='0' :scroll-with-animation=\"scrollAnimation\" :scroll-top=\"scrollTop\" :scroll-into-view=\"scrollToView\" @scrolltoupper=\"loadHistory\" upper-threshold=\"50\">\n            \t<!-- 加载历史数据waitingUI -->\n            \t<view v-if=\"isHistoryLoading\" class=\"loading\">\n            \t\t<view class=\"spinner\">\n            \t\t\t<view class=\"rect1\"></view>\n            \t\t\t<view class=\"rect2\"></view>\n            \t\t\t<view class=\"rect3\"></view>\n            \t\t\t<view class=\"rect4\"></view>\n            \t\t\t<view class=\"rect5\"></view>\n            \t\t</view>\n            \t</view>\n                <view class=\"row\" v-for=\"(row,index) in msgList\" :key=\"index\" :id=\"'msg'+row.msg.id\">\n                \t<block v-if=\"row.type=='suggest'\" >\n                        <view class=\"suggest-box\" @click=\"clickEndSuggest(row)\">\n                            <view class=\"suggest\">\n                                <view class=\"suggest-title\">\n                                    专家建议\n                                </view>\n                                <view class=\"suggest-des\">\n                                    {{row.msg.content.text}}\n                                </view>\n                                <view class=\"suggest-xing\" >\n                                    <text v-if=\"row.msg.score==null\">用户暂未评价</text>\n                                    <image v-if=\"row.msg.score\" src=\"../../static/image/img_star_pj64.png\" mode=\"\"></image>\n                                    <image v-if=\"row.msg.score>1\"  src=\"../../static/image/img_star_pj64.png\" mode=\"\"></image>\n                                    <image v-if=\"row.msg.score>2\"  src=\"../../static/image/img_star_pj64.png\" mode=\"\"></image>\n                                    <image v-if=\"row.msg.score>3\"  src=\"../../static/image/img_star_pj64.png\" mode=\"\"></image>\n                                    <image v-if=\"row.msg.score>4\"  src=\"../../static/image/img_star_pj64.png\" mode=\"\"></image>\n                                </view>\n                                <view class=\"suggest-btn\">\n                                    <view class=\"suggest-btn-txt\">\n                                        查看详情\n                                    </view>\n                                    <image src=\"../../static/image/icon_jyxq_jt.png\" mode=\"\"></image>\n                                </view>\n                            </view>\n                        </view>\n                    </block>\n                    <!-- 系统消息 -->\n                \t<block v-if=\"row.type=='system'\" >\n                \t\t<view class=\"system\">\n                \t\t\t<!-- 文字消息 -->\n                \t\t\t<view v-if=\"row.msg.type=='text'\" class=\"text\">\n                \t\t\t\t{{row.msg.content.text}}\n                \t\t\t</view>\n                \t\t\t<!-- 领取红包消息 -->\n                \t\t\t<view v-if=\"row.msg.type=='redEnvelope'\" class=\"red-envelope\">\n                \t\t\t\t<image src=\"/static/img/red-envelope-chat.png\"></image>\n                \t\t\t\t{{row.msg.content.text}}\n                \t\t\t</view>\n                \t\t</view>\n                \t</block>\n                \t<!-- 用户消息 -->\n                \t<block v-if=\"row.type=='user'\">\n                \t\t<!-- 自己发出的消息 -->\n                \t\t<view class=\"my\" v-if=\"row.msg.userinfo.uid==myuid\">\n                \t\t\t<!-- 左-消息 -->\n                \t\t\t<view class=\"left\">\n                \t\t\t\t<!-- 文字消息 -->\n                \t\t\t\t<view v-if=\"row.msg.type=='text'\" class=\"bubble\">\n                \t\t\t\t\t<rich-text :nodes=\"row.msg.content.text\"></rich-text>\n                \t\t\t\t</view>\n                \t\t\t\t<!-- 语言消息 -->\n                \t\t\t\t<view v-if=\"row.msg.type=='voice'\" :style=\"{'width': row.msg.content.length/60*70+15 +'%' }\" class=\"bubble voice\" @tap=\"playVoice(row.msg)\" :class=\"playMsgid == row.msg.id?'play':''\">\n                \t\t\t\t\t<view class=\"length\">{{row.msg.content.length+'\"'}} </view>\n                \t\t\t\t\t<view class=\"icon my-voice\"></view>\n                \t\t\t\t</view>\n                \t\t\t\t<!-- 图片消息 -->\n                \t\t\t\t<view v-if=\"row.msg.type=='img'\" class=\"bubble img\" @tap=\"showPic(row.msg)\">\n                \t\t\t\t\t<image :src=\"row.msg.content.url\" :style=\"{'width': row.msg.content.w+'px','height': row.msg.content.h+'px'}\"></image>\n                \t\t\t\t</view>\n                \t\t\t\t<!-- 红包 -->\n                \t\t\t\t<view v-if=\"row.msg.type=='redEnvelope'\" class=\"bubble red-envelope\" @tap=\"openRedEnvelope(row.msg,index)\">\n                \t\t\t\t\t<image src=\"/static/img/red-envelope.png\"></image>\n                \t\t\t\t\t<view class=\"tis\">\n                \t\t\t\t\t\t<!-- 点击开红包 -->\n                \t\t\t\t\t</view>\n                \t\t\t\t\t<view class=\"blessing\">\n                \t\t\t\t\t\t{{row.msg.content.blessing}}\n                \t\t\t\t\t</view>\n                \t\t\t\t</view>\n                \t\t\t\t\n                \t\t\t</view>\n                \t\t\t<!-- 右-头像 -->\n                \t\t\t<view class=\"right\">\n                \t\t\t\t<image :src=\"row.msg.userinfo.face\"></image>\n                \t\t\t</view>\n                \t\t</view>\n                \t\t<!-- 别人发出的消息 -->\n                \t\t<view class=\"other\" v-if=\"row.msg.userinfo.uid!=myuid\">\n                \t\t\t<!-- 左-头像 -->\n                \t\t\t<view class=\"left\">\n                \t\t\t\t<image :src=\"row.msg.userinfo.face\"></image>\n                \t\t\t</view>\n                \t\t\t<!-- 右-用户名称-时间-消息 -->\n                \t\t\t<view class=\"right\">\n                \t\t\t\t<!-- <view class=\"username\">\n                \t\t\t\t\t<view class=\"name\">{{row.msg.userinfo.username}}</view> <view class=\"time\">{{row.msg.time}}</view>\n                \t\t\t\t</view> -->\n                \t\t\t\t<!-- 文字消息 -->\n                \t\t\t\t<view v-if=\"row.msg.type=='text'\" class=\"bubble\">\n                \t\t\t\t\t<rich-text :nodes=\"row.msg.content.text\"></rich-text>\n                \t\t\t\t</view>\n                \t\t\t\t<!-- 语音消息 -->\n                \t\t\t\t<view v-if=\"row.msg.type=='voice'\" class=\"bubble voice\" @tap=\"playVoice(row.msg)\" :class=\"playMsgid == row.msg.id?'play':''\">\n                \t\t\t\t\t<view class=\"icon other-voice\"></view>\n                \t\t\t\t\t<view class=\"length\">{{row.msg.content.length}}</view>\n                \t\t\t\t</view>\n                \t\t\t\t<!-- 图片消息 -->\n                \t\t\t\t<view v-if=\"row.msg.type=='img'\" class=\"bubble img\" @tap=\"showPic(row.msg)\">\n                \t\t\t\t\t<image :src=\"row.msg.content.url\" :style=\"{'width': row.msg.content.w+'px','height': row.msg.content.h+'px'}\"></image>\n                \t\t\t\t</view>\n                \t\t\t\t<!-- 红包 -->\n                \t\t\t\t<view v-if=\"row.msg.type=='redEnvelope'\" class=\"bubble red-envelope\" @tap=\"openRedEnvelope(row.msg,index)\">\n                \t\t\t\t\t<image src=\"/static/img/red-envelope.png\"></image>\n                \t\t\t\t\t<view class=\"tis\">\n                \t\t\t\t\t\t<!-- 点击开红包 -->\n                \t\t\t\t\t</view>\n                \t\t\t\t\t<view class=\"blessing\">\n                \t\t\t\t\t\t{{row.msg.content.blessing}}\n                \t\t\t\t\t</view>\n                \t\t\t\t</view>\n                \t\t\t</view>\n                \t\t</view>\n                \t</block>\n                </view>\n            </scroll-view>\n        </view>\n        <!-- 底部输入栏 -->\n        <view v-if='isFinish != 1' class=\"input-box\" :class=\"popupLayerClass\" @touchmove.stop.prevent=\"discard\">\n        \t<!-- <view class=\"picbox\" @click=\"getImage('album')\">\n        \t    <image src=\"../../static/image/icon_lt_fstp.png\" class=\"img\" mode=\"\"></image>\n        \t</view> -->\n            <view class=\"picbox\" @tap=\"switchVoice\">\n                <image :src=\"jianpanicon\" class=\"img\" mode=\"\"></image>\n            \t<!-- <view class=\"icon\" :class=\"isVoice?'jianpan':'yuyin'\" @tap=\"switchVoice\"></view> -->\n            </view>\n        \t<view class=\"textbox\">\n        \t\t<view class=\"voice-mode\" :class=\"[isVoice?'':'hidden',recording?'recording':'']\" @touchstart=\"voiceBegin\" @touchmove.stop.prevent=\"voiceIng\" @touchend=\"voiceEnd\" @touchcancel=\"voiceCancel\">{{voiceTis}}</view>\n        \t\t<view class=\"text-mode\"  :class=\"isVoice?'hidden':''\">\n        \t\t\t<view class=\"box\">\n        \t\t\t\t<input v-if=\"showPlaceholder\" placeholder-class=\"input-placeholder\" auto-height=\"true\" @confirm=\"sendText\" v-model=\"textMsg\" @focus=\"textareaFocus\" placeholder=\"请输入内容\" confirm-type=\"send\" />\n        \t\t\t</view>\n        \t\t\t<!-- <view class=\"em\" @tap=\"chooseEmoji\">\n        \t\t\t\t<view class=\"icon biaoqing\"></view>\n        \t\t\t</view> @tap=\"sendText\"-->\n        \t\t</view>\n        \t</view>\n        \t\n        \t<view style=\"margin-left: 20upx;\" class=\"picbox\"  @click=\"getImage('album')\">\n        \t\t<!-- <view class=\"btn\">发送</view> -->\n                <image src=\"../../static/image/icon_lt_fstp.png\" class=\"img\" mode=\"\"></image>\n        \t</view>\n        </view>\n        <!-- 录音UI效果 -->\n        <view class=\"record\" :class=\"recording?'':'hidden'\">\n        \t<view class=\"ing\" :class=\"willStop?'hidden':''\"><view class=\"icon luyin2\" ></view></view>\n        \t<view class=\"cancel\" :class=\"willStop?'':'hidden'\"><view class=\"icon chehui\" ></view></view>\n        \t<view class=\"tis\" :class=\"willStop?'change':''\">{{recordTis}}</view>\n        </view>\n        <view v-if='isFinish == 1'  @click=\"clickSuggest\" class=\"suggest-input\">\n            建议\n        </view>\n        <xy-dialog ref=\"dialog\" :score='score' :type='dialogtype' @confirmButton=\"confirmButton\" @cancelButton=\"cancelButton\" :content.sync=\"content\" :lastMsgTime.sync=\"lastMsgTime\"\n            ></xy-dialog>\n    </view>\n</template>\n\n<script>\n    import api from '../../common/api.js';\n    import util from '../../common/util.js';\n    import xyDialog from '../../components/xy-dialog/xy-dialog.vue'\n    \n    export default {\n        components: {\n            xyDialog\n        },\n    \tdata() {\n    \t\treturn {\n                jianpanicon:'../../static/image/icon_yysr.png',\n                showPlaceholder:true,\n                isRequest:false,\n                dialogtype:1,\n                score:null,\n                draft:null,\n                content:'',\n                lastMsgTime:'',\n                page:1,\n                size:10,\n                userId:null,\n                \n                uploadParams:null,\n                \n                messageList:[],\n                \n                isFinish:null,\n                isload:false,\n    \t\t\t//文字消息\n    \t\t\ttextMsg:'',\n    \t\t\t//消息列表\n    \t\t\tisHistoryLoading:false,\n    \t\t\tscrollAnimation:false,\n    \t\t\tscrollTop:0,\n    \t\t\tscrollToView:'',\n    \t\t\tmsgList:[],\n    \t\t\tmsgImgList:[],\n    \t\t\tmyuid:0,\n    \t\t\t\n    \t\t\t//录音相关参数\n    \t\t\t// #ifndef H5\n    \t\t\t//H5不能录音\n    \t\t\tRECORDER:uni.getRecorderManager(),\n    \t\t\t// #endif\n    \t\t\tisVoice:false,\n    \t\t\tvoiceTis:'按住 说话',\n    \t\t\trecordTis:\"手指上滑 取消发送\",\n    \t\t\trecording:false,\n    \t\t\twillStop:false,\n    \t\t\tinitPoint:{identifier:0,Y:0},\n    \t\t\trecordTimer:null,\n    \t\t\trecordLength:0,\n    \t\t\t\n    \t\t\t//播放语音相关参数\n    \t\t\tAUDIO:uni.createInnerAudioContext(),\n    \t\t\tplayMsgid:null,\n    \t\t\tVoiceTimer:null,\n    \t\t\t// 抽屉参数\n    \t\t\tpopupLayerClass:'',\n    \t\t\t// more参数\n    \t\t\thideMore:true,\n    \t\t\t//表情定义\n    \t\t\thideEmoji:true,\n    \t\t\temojiList:[\n    \t\t\t\t[{\"url\":\"100.gif\",alt:\"[微笑]\"},{\"url\":\"101.gif\",alt:\"[伤心]\"},{\"url\":\"102.gif\",alt:\"[美女]\"},{\"url\":\"103.gif\",alt:\"[发呆]\"},{\"url\":\"104.gif\",alt:\"[墨镜]\"},{\"url\":\"105.gif\",alt:\"[哭]\"},{\"url\":\"106.gif\",alt:\"[羞]\"},{\"url\":\"107.gif\",alt:\"[哑]\"},{\"url\":\"108.gif\",alt:\"[睡]\"},{\"url\":\"109.gif\",alt:\"[哭]\"},{\"url\":\"110.gif\",alt:\"[囧]\"},{\"url\":\"111.gif\",alt:\"[怒]\"},{\"url\":\"112.gif\",alt:\"[调皮]\"},{\"url\":\"113.gif\",alt:\"[笑]\"},{\"url\":\"114.gif\",alt:\"[惊讶]\"},{\"url\":\"115.gif\",alt:\"[难过]\"},{\"url\":\"116.gif\",alt:\"[酷]\"},{\"url\":\"117.gif\",alt:\"[汗]\"},{\"url\":\"118.gif\",alt:\"[抓狂]\"},{\"url\":\"119.gif\",alt:\"[吐]\"},{\"url\":\"120.gif\",alt:\"[笑]\"},{\"url\":\"121.gif\",alt:\"[快乐]\"},{\"url\":\"122.gif\",alt:\"[奇]\"},{\"url\":\"123.gif\",alt:\"[傲]\"}],\n    \t\t\t\t[{\"url\":\"124.gif\",alt:\"[饿]\"},{\"url\":\"125.gif\",alt:\"[累]\"},{\"url\":\"126.gif\",alt:\"[吓]\"},{\"url\":\"127.gif\",alt:\"[汗]\"},{\"url\":\"128.gif\",alt:\"[高兴]\"},{\"url\":\"129.gif\",alt:\"[闲]\"},{\"url\":\"130.gif\",alt:\"[努力]\"},{\"url\":\"131.gif\",alt:\"[骂]\"},{\"url\":\"132.gif\",alt:\"[疑问]\"},{\"url\":\"133.gif\",alt:\"[秘密]\"},{\"url\":\"134.gif\",alt:\"[乱]\"},{\"url\":\"135.gif\",alt:\"[疯]\"},{\"url\":\"136.gif\",alt:\"[哀]\"},{\"url\":\"137.gif\",alt:\"[鬼]\"},{\"url\":\"138.gif\",alt:\"[打击]\"},{\"url\":\"139.gif\",alt:\"[bye]\"},{\"url\":\"140.gif\",alt:\"[汗]\"},{\"url\":\"141.gif\",alt:\"[抠]\"},{\"url\":\"142.gif\",alt:\"[鼓掌]\"},{\"url\":\"143.gif\",alt:\"[糟糕]\"},{\"url\":\"144.gif\",alt:\"[恶搞]\"},{\"url\":\"145.gif\",alt:\"[什么]\"},{\"url\":\"146.gif\",alt:\"[什么]\"},{\"url\":\"147.gif\",alt:\"[累]\"}],\n    \t\t\t\t[{\"url\":\"148.gif\",alt:\"[看]\"},{\"url\":\"149.gif\",alt:\"[难过]\"},{\"url\":\"150.gif\",alt:\"[难过]\"},{\"url\":\"151.gif\",alt:\"[坏]\"},{\"url\":\"152.gif\",alt:\"[亲]\"},{\"url\":\"153.gif\",alt:\"[吓]\"},{\"url\":\"154.gif\",alt:\"[可怜]\"},{\"url\":\"155.gif\",alt:\"[刀]\"},{\"url\":\"156.gif\",alt:\"[水果]\"},{\"url\":\"157.gif\",alt:\"[酒]\"},{\"url\":\"158.gif\",alt:\"[篮球]\"},{\"url\":\"159.gif\",alt:\"[乒乓]\"},{\"url\":\"160.gif\",alt:\"[咖啡]\"},{\"url\":\"161.gif\",alt:\"[美食]\"},{\"url\":\"162.gif\",alt:\"[动物]\"},{\"url\":\"163.gif\",alt:\"[鲜花]\"},{\"url\":\"164.gif\",alt:\"[枯]\"},{\"url\":\"165.gif\",alt:\"[唇]\"},{\"url\":\"166.gif\",alt:\"[爱]\"},{\"url\":\"167.gif\",alt:\"[分手]\"},{\"url\":\"168.gif\",alt:\"[生日]\"},{\"url\":\"169.gif\",alt:\"[电]\"},{\"url\":\"170.gif\",alt:\"[炸弹]\"},{\"url\":\"171.gif\",alt:\"[刀子]\"}],\n    \t\t\t\t[{\"url\":\"172.gif\",alt:\"[足球]\"},{\"url\":\"173.gif\",alt:\"[瓢虫]\"},{\"url\":\"174.gif\",alt:\"[翔]\"},{\"url\":\"175.gif\",alt:\"[月亮]\"},{\"url\":\"176.gif\",alt:\"[太阳]\"},{\"url\":\"177.gif\",alt:\"[礼物]\"},{\"url\":\"178.gif\",alt:\"[抱抱]\"},{\"url\":\"179.gif\",alt:\"[拇指]\"},{\"url\":\"180.gif\",alt:\"[贬低]\"},{\"url\":\"181.gif\",alt:\"[握手]\"},{\"url\":\"182.gif\",alt:\"[剪刀手]\"},{\"url\":\"183.gif\",alt:\"[抱拳]\"},{\"url\":\"184.gif\",alt:\"[勾引]\"},{\"url\":\"185.gif\",alt:\"[拳头]\"},{\"url\":\"186.gif\",alt:\"[小拇指]\"},{\"url\":\"187.gif\",alt:\"[拇指八]\"},{\"url\":\"188.gif\",alt:\"[食指]\"},{\"url\":\"189.gif\",alt:\"[ok]\"},{\"url\":\"190.gif\",alt:\"[情侣]\"},{\"url\":\"191.gif\",alt:\"[爱心]\"},{\"url\":\"192.gif\",alt:\"[蹦哒]\"},{\"url\":\"193.gif\",alt:\"[颤抖]\"},{\"url\":\"194.gif\",alt:\"[怄气]\"},{\"url\":\"195.gif\",alt:\"[跳舞]\"}],\n    \t\t\t\t[{\"url\":\"196.gif\",alt:\"[发呆]\"},{\"url\":\"197.gif\",alt:\"[背着]\"},{\"url\":\"198.gif\",alt:\"[伸手]\"},{\"url\":\"199.gif\",alt:\"[耍帅]\"},{\"url\":\"200.png\",alt:\"[微笑]\"},{\"url\":\"201.png\",alt:\"[生病]\"},{\"url\":\"202.png\",alt:\"[哭泣]\"},{\"url\":\"203.png\",alt:\"[吐舌]\"},{\"url\":\"204.png\",alt:\"[迷糊]\"},{\"url\":\"205.png\",alt:\"[瞪眼]\"},{\"url\":\"206.png\",alt:\"[恐怖]\"},{\"url\":\"207.png\",alt:\"[忧愁]\"},{\"url\":\"208.png\",alt:\"[眨眉]\"},{\"url\":\"209.png\",alt:\"[闭眼]\"},{\"url\":\"210.png\",alt:\"[鄙视]\"},{\"url\":\"211.png\",alt:\"[阴暗]\"},{\"url\":\"212.png\",alt:\"[小鬼]\"},{\"url\":\"213.png\",alt:\"[礼物]\"},{\"url\":\"214.png\",alt:\"[拜佛]\"},{\"url\":\"215.png\",alt:\"[力量]\"},{\"url\":\"216.png\",alt:\"[金钱]\"},{\"url\":\"217.png\",alt:\"[蛋糕]\"},{\"url\":\"218.png\",alt:\"[彩带]\"},{\"url\":\"219.png\",alt:\"[礼物]\"},]\t\t\t\t\n    \t\t\t],\n    \t\t\t//表情图片图床名称 ，由于我上传的第三方图床名称会有改变，所以有此数据来做对应，您实际应用中应该不需要\n    \t\t\tonlineEmoji:{\"100.gif\":\"AbNQgA.gif\",\"101.gif\":\"AbN3ut.gif\",\"102.gif\":\"AbNM3d.gif\",\"103.gif\":\"AbN8DP.gif\",\"104.gif\":\"AbNljI.gif\",\"105.gif\":\"AbNtUS.gif\",\"106.gif\":\"AbNGHf.gif\",\"107.gif\":\"AbNYE8.gif\",\"108.gif\":\"AbNaCQ.gif\",\"109.gif\":\"AbNN4g.gif\",\"110.gif\":\"AbN0vn.gif\",\"111.gif\":\"AbNd3j.gif\",\"112.gif\":\"AbNsbV.gif\",\"113.gif\":\"AbNwgs.gif\",\"114.gif\":\"AbNrD0.gif\",\"115.gif\":\"AbNDuq.gif\",\"116.gif\":\"AbNg5F.gif\",\"117.gif\":\"AbN6ET.gif\",\"118.gif\":\"AbNcUU.gif\",\"119.gif\":\"AbNRC4.gif\",\"120.gif\":\"AbNhvR.gif\",\"121.gif\":\"AbNf29.gif\",\"122.gif\":\"AbNW8J.gif\",\"123.gif\":\"AbNob6.gif\",\"124.gif\":\"AbN5K1.gif\",\"125.gif\":\"AbNHUO.gif\",\"126.gif\":\"AbNIDx.gif\",\"127.gif\":\"AbN7VK.gif\",\"128.gif\":\"AbNb5D.gif\",\"129.gif\":\"AbNX2d.gif\",\"130.gif\":\"AbNLPe.gif\",\"131.gif\":\"AbNjxA.gif\",\"132.gif\":\"AbNO8H.gif\",\"133.gif\":\"AbNxKI.gif\",\"134.gif\":\"AbNzrt.gif\",\"135.gif\":\"AbU9Vf.gif\",\"136.gif\":\"AbUSqP.gif\",\"137.gif\":\"AbUCa8.gif\",\"138.gif\":\"AbUkGQ.gif\",\"139.gif\":\"AbUFPg.gif\",\"140.gif\":\"AbUPIS.gif\",\"141.gif\":\"AbUZMn.gif\",\"142.gif\":\"AbUExs.gif\",\"143.gif\":\"AbUA2j.gif\",\"144.gif\":\"AbUMIU.gif\",\"145.gif\":\"AbUerq.gif\",\"146.gif\":\"AbUKaT.gif\",\"147.gif\":\"AbUmq0.gif\",\"148.gif\":\"AbUuZV.gif\",\"149.gif\":\"AbUliF.gif\",\"150.gif\":\"AbU1G4.gif\",\"151.gif\":\"AbU8z9.gif\",\"152.gif\":\"AbU3RJ.gif\",\"153.gif\":\"AbUYs1.gif\",\"154.gif\":\"AbUJMR.gif\",\"155.gif\":\"AbUadK.gif\",\"156.gif\":\"AbUtqx.gif\",\"157.gif\":\"AbUUZ6.gif\",\"158.gif\":\"AbUBJe.gif\",\"159.gif\":\"AbUdIO.gif\",\"160.gif\":\"AbU0iD.gif\",\"161.gif\":\"AbUrzd.gif\",\"162.gif\":\"AbUDRH.gif\",\"163.gif\":\"AbUyQA.gif\",\"164.gif\":\"AbUWo8.gif\",\"165.gif\":\"AbU6sI.gif\",\"166.gif\":\"AbU2eP.gif\",\"167.gif\":\"AbUcLt.gif\",\"168.gif\":\"AbU4Jg.gif\",\"169.gif\":\"AbURdf.gif\",\"170.gif\":\"AbUhFS.gif\",\"171.gif\":\"AbU5WQ.gif\",\"172.gif\":\"AbULwV.gif\",\"173.gif\":\"AbUIzj.gif\",\"174.gif\":\"AbUTQs.gif\",\"175.gif\":\"AbU7yn.gif\",\"176.gif\":\"AbUqe0.gif\",\"177.gif\":\"AbUHLq.gif\",\"178.gif\":\"AbUOoT.gif\",\"179.gif\":\"AbUvYF.gif\",\"180.gif\":\"AbUjFU.gif\",\"181.gif\":\"AbaSSJ.gif\",\"182.gif\":\"AbUxW4.gif\",\"183.gif\":\"AbaCO1.gif\",\"184.gif\":\"Abapl9.gif\",\"185.gif\":\"Aba9yR.gif\",\"186.gif\":\"AbaFw6.gif\",\"187.gif\":\"Abaiex.gif\",\"188.gif\":\"AbakTK.gif\",\"189.gif\":\"AbaZfe.png\",\"190.gif\":\"AbaEFO.gif\",\"191.gif\":\"AbaVYD.gif\",\"192.gif\":\"AbamSH.gif\",\"193.gif\":\"AbaKOI.gif\",\"194.gif\":\"Abanld.gif\",\"195.gif\":\"Abau6A.gif\",\"196.gif\":\"AbaQmt.gif\",\"197.gif\":\"Abal0P.gif\",\"198.gif\":\"AbatpQ.gif\",\"199.gif\":\"Aba1Tf.gif\",\"200.png\":\"Aba8k8.png\",\"201.png\":\"AbaGtS.png\",\"202.png\":\"AbaJfg.png\",\"203.png\":\"AbaNlj.png\",\"204.png\":\"Abawmq.png\",\"205.png\":\"AbaU6s.png\",\"206.png\":\"AbaaXn.png\",\"207.png\":\"Aba000.png\",\"208.png\":\"AbarkT.png\",\"209.png\":\"AbastU.png\",\"210.png\":\"AbaB7V.png\",\"211.png\":\"Abafn1.png\",\"212.png\":\"Abacp4.png\",\"213.png\":\"AbayhF.png\",\"214.png\":\"Abag1J.png\",\"215.png\":\"Aba2c9.png\",\"216.png\":\"AbaRXR.png\",\"217.png\":\"Aba476.png\",\"218.png\":\"Abah0x.png\",\"219.png\":\"Abdg58.png\"},\n    \t\t\t//红包相关参数\n    \t\t\twindowsState:'',\n    \t\t\tredenvelopeData:{\n    \t\t\t\trid:null,\t//红包ID\n    \t\t\t\tfrom:null,\n    \t\t\t\tface:null,\n    \t\t\t\tblessing:null,\n    \t\t\t\tmoney:null\n    \t\t\t},\n                \n                userinfo:null\n    \t\t}\n    \t},\n        onHide() {\n            console.log('clearInterval')\n            clearInterval(this.interval );//停止\n        },\n        onUnload(){\n            console.log('clearInterval')\n            clearInterval(this.interval );//停止\n        },\n    \tonLoad(option) {\n            \n            this.userId = option.userId\n            \n            this.userinfo = uni.getStorageSync(\"userinfo\")\n            if(this.userinfo.icon){\n                this.userinfo.icon = JSON.parse(this.userinfo.icon)[0].url\n            }\n            \n            uni.setNavigationBarTitle({\n                title:option.title\n            });\n            const data = {\n            \tpurpose: 'useravatar'\n            }\n            api.getUploadParams({\n            \tdata: data\n            }).then(res => {\n            \tconsole.log('getUploadParams')\n            \tconsole.log(res)\n            \tthis.uploadParams = res.data\n            })\n            api.managerRead({\n                data:{\n                    fromId:this.userinfo.id,\n                    toId:this.userId\n                }\n            }).then(res=>{\n                \n            })\n            // api.managerRead({\n            //     data:{\n            //         fromId:this.userId,\n            //         toId:this.userinfo.id,\n            //     }\n            // }).then(res=>{\n                \n            // })\n            \n            this.initMsgList();\n            var _self = this\n            this.interval = setInterval(function(){ \n                _self.updateLastMsg()\n            }, 10000);\n            \n            //语音自然播放结束\n            this.AUDIO.onEnded((res)=>{\n            \tthis.playMsgid=null;\n            });\n            // #ifndef H5\n            //录音开始事件\n            this.RECORDER.onStart((e)=>{\n            \tthis.recordBegin(e);\n            })\n            //录音结束事件\n            this.RECORDER.onStop((e)=>{\n            \tthis.recordEnd(e);\n            })\n            // #endif\n    \t},\n    \tmethods: {\n            \n            updateLastMsg:function(){\n                \n                // if(this.isRequest){\n                //     return\n                // }\n                this.isRequest = true\n                \n                var dangqianid \r\n\t\t\t\tvar isRe = false\r\n\t\t\t\tif(this.msgList.length<=0){\r\n\t\t\t\t\tisRe = true\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdangqianid = this.msgList[this.msgList.length-1].msg.id\r\n\t\t\t\t}\r\n\t\t\t\t\n                var data = {\n                    page:1,\n                    size:20,\n                    userId:this.userId,\n                }\n                let _self = this;\n                var list = []\n                var currentDate = ''\n                \n                api.managerMsgPage({\n                    data: data\n                }).then(listRes => {\n                    console.log(listRes)\n                    var today = util.formatDate(new Date, 'yyyy-MM-dd')\n                    if(listRes.status=='OK' && listRes.list.length>0 ){\n                        \n                        for(var index = listRes.list.length-1;index>=0;index--){\n                        \n                            var item = listRes.list[index]\n                            \n                            if(isRe){\n                                var date = util.formatTimestamp(item.time, 'yyyy-MM-dd')\n                                                        \n                                var time = util.formatTimestamp(item.time,'hh:mm')\n                                \n                                if(!item.extJson){\n                                    var message = {}\n                                    message.type = 'user'\n                                    message.msg = {}\n                                    message.msg.id = item.id\n                                    \n                                    if(item.type=='txt'){       //文字类型\n                                        message.msg.type = \"text\"\n                                    }else if(item.type=='img'){     //图片类型\n                                        message.msg.type = \"img\"\n                                    }else if(item.type=='audio'){\n                                        message.msg.type = \"voice\"\n                                    }\n                                    \n                                    message.msg.time = time\n                                    message.msg.userinfo = {}\n                                    if(item.fromId == this.userinfo.id){\n                                        //自己发的消息\n                                        message.msg.userinfo.uid = 0\n                                        message.msg.userinfo.username = this.userinfo.name\n                                        message.msg.userinfo.face = this.userinfo.icon\n                                    }else{\n                                        //对方发的消息\n                                        message.msg.userinfo.uid = item.userId\n                                        message.msg.userinfo.username = item.displayName\n                                        message.msg.userinfo.face = item.displayAvatar\n                                    }\n                                    message.msg.content = {}\n                                    if(item.type=='txt'){       //文字类型\n                                        message.msg.content.text = item.content\n                                    }else if(item.type=='img'){     //图片类型\n                                        message.msg.content.url = item.url\n                                    }else if(item.type=='audio'){\n                                        message.msg.content.url = item.url\n                                        message.msg.content.length = item.content\n                                    }\n                                    \n                                    _self.msgList.push(message)\n                                }else{\n                                    var message = {}\n                                    //{type:\"system\",msg:{id:0,type:\"text\",content:{text:\"欢迎进入HM-chat聊天室\"}}},\n                                    // message.type = 'system'\n                                    // message.msg = {}\n                                    // message.msg.id = item.id\n                                    // message.msg.type = \"text\"\n                                    // message.msg.content = {}\n                                    // message.msg.content.text = item.content\n                                                      \n                                    // _self.msgList.push(message)\n                                    \n                                    var extContent = JSON.parse(item.extJson)\n                                    var message = {}\n                                    message.type = 'suggest'\n                                    message.msg = {}\n                                    message.msg.id = item.id\n                                    message.msg.time = date\n                                    message.msg.content = {}\n                                    message.msg.content.text = extContent.content\n                                    message.msg.score = extContent.score\n                                    _self.msgList.push(message)\n                                }\n                                \n                                _self.$nextTick(function() {\n                                    \n                                    uni.createSelectorQuery().select('.msg-list').fields({\n                                        size: true,\n                                        scrollOffset: true\n                                    }, (data) => {\n                                        console.log(data);\n                                        //进入页面滚动到底部\n                                        _self.scrollTop = data.scrollHeight;\n                                        \t\n                                    }).exec();\n                                    _self.$nextTick(function() {\n                                        _self.scrollAnimation = true;\n                                    });\n                                });\n                               \n                                \n                            }\n                            if(dangqianid == item.id){\n                                isRe = true\n                            }\n                        }\n                        \n                    }\n                  \n                     _self.isRequest = false\n                })\n            },\n            clickEndSuggest:function(item){\n                this.showPlaceholder = true\n                this.content = item.msg.content.text\n                this.lastMsgTime = item.msg.time\n                console.log(item.msg.score)\n                this.score = item.msg.score\n                console.log(this.score)\n                this.dialogtype = 2\n                this.$refs.dialog.confirm()\n            },\n            confirmButton:function(content){\n                this.showPlaceholder = true\n                let _self = this;\n                uni.showModal({\n                    title: '确定提交',\n                    content: '提交用户即发送给用户，不可撤回修改，点击确定继续。',\n                    // showCancel: false,\n                    cancelColor: \"#03BE90\",\n                    confirmColor: \"#03BE90\",\n                    success: function(res) {\n                        if (res.confirm) {\n                            var rid\n                            \n                            var data = {\n                            \tcontext: content,\n                                recordId:_self.recordId,\n                                communityId:_self.communityId\n                            }\n                            if(_self.draft){\n                                data = {\n                                \tcontext: content,\n                                    recordId:_self.recordId,\n                                    id:_self.draft.id,\n                                    communityId:_self.communityId\n                                }\n                            }\n                            api.addAnalysis({\n                                data: data\n                            }).then(res => {\n                                console.log(res)\n                                \n                                _self.updateLastMsg()\n                            })\n                        }\n                    },\n                })\n                \n            },\n            cancelButton:function(content){\n                this.showPlaceholder = true\n                console.log(content)\n                if(content!=''){\n                    \n                    var data = {\n                    \tcontext: content,\n                        recordId:this.recordId,\n                    }\n                    if(this.draft){\n                        data = {\n                        \tcontext: content,\n                            recordId:this.recordId,\n                            id:this.draft.id\n                        } \n                    }\n                    api.saveDraft({\n                        data: data\n                    }).then(res => {\n                        console.log(res)\n                    })\n                }\n            },\n            clickSendPic:function(){\n                var _self = this;\n                uni.chooseImage({\n                \tcount: 1, //默认9\n                \tsizeType: ['original', 'compressed'], //可以指定是原图还是压缩图，默认二者都有\n                \t//sourceType: ['album'], 从相册选择\n                \tsuccess: function(res) {\n                \t\tconsole.log(res.tempFilePaths[0]);\n                \t\tif (_self.uploadParams) {\n                \t\t\tuni.showLoading({\n                \t\t\t\ttitle: '图片上传中'\n                \t\t\t})\n                \t\t\tuni.uploadFile({\n                \t\t\t\turl: _self.uploadParams.url,\n                \t\t\t\tfilePath: res.tempFilePaths[0],\n                \t\t\t\tname: 'userAvatar',\n                \t\t\t\tformData: {\n                \t\t\t\t\tpolicy: _self.uploadParams.policy,\n                \t\t\t\t\tSignature: _self.uploadParams.Signature\n                \t\t\t\t},\n                \t\t\t\tsuccess(result) {\n                \t\t\t\t\tif (result.data) {\n                                        console.log(result.data);\n                \t\t\t\t\t\tlet r = JSON.parse(result.data)\n                \t\t\t\t\t\tif (r.status === 'OK') {\n                \t\t\t\t\t\t\t\n                \t\t\t\t\t\t} else {\n                \t\t\t\t\t\t\tuni.showToast({\n                \t\t\t\t\t\t\t\ttitle: r.message,\n                \t\t\t\t\t\t\t\ticon: \"none\",\n                \t\t\t\t\t\t\t\tduration: 2000\n                \t\t\t\t\t\t\t})\n                \t\t\t\t\t\t}\n                \t\t\t\t\t}\n                \t\t\t\t},\n                \t\t\t\tfail() {\n                \n                \t\t\t\t},\n                \t\t\t\tcomplete(res) {\n                \t\t\t\t\tuni.hideLoading()\n                \t\t\t\t\tif (res.statusCode !== 200) {\n                \t\t\t\t\t\tuni.showToast({\n                \t\t\t\t\t\t\ttitle: res.errMsg,\n                \t\t\t\t\t\t\ticon: \"none\",\n                \t\t\t\t\t\t\tduration: 2000\n                \t\t\t\t\t\t})\n                \t\t\t\t\t}\n                \t\t\t\t}\n                \t\t\t})\n                \t\t} else {\n                \t\t\tuni.showToast({\n                \t\t\t\ttitle: 'getUploadParams failed!',\n                \t\t\t\ticon: \"none\",\n                \t\t\t\tduration: 2000\n                \t\t\t})\n                \t\t}\n                \t},\n                \tfail: function(e) {\n                \n                \t}\n                });\n            },\n            clickSuggest:function(){\n               \n                this.showPlaceholder = false\n                const data = {\n                \trecordId: this.recordId\n                }\n                api.findByRecordIdDraft({\n                \tdata: data\n                }).then(res => {\n                    console.log(res)\n                    if(res.status == 'OK' && res.data != null  && res.data != ''){\n                        this.content = res.data.analysis\n                        this.draft = res.data\n                        if(res.data.lastUpdateTime){\n                            var date = util.formatTimestamp(res.data.lastUpdateTime, 'yyyy-MM-dd')\n                                                  \n                            var time = util.formatTimestamp(res.data.lastUpdateTime,'hh:mm')\n                            \n                            this.lastMsgTime = date + ' ' +time\n                        }else{\n                            var date = util.formatTimestamp(res.data.createTime, 'yyyy-MM-dd')\n                                                  \n                            var time = util.formatTimestamp(res.data.createTime,'hh:mm')\n                            \n                            this.lastMsgTime = date + ' ' +time\n                        }\n                    }else{\n                        this.content = ''\n                        this.lastMsgTime = ''\n                    }\n                    this.dialogtype = 1\n                    this.$refs.dialog.confirm()\n                })\n                \n                \n            },\n            // 切换语音/文字输入\n            switchVoice(){\n            \tthis.hideDrawer();\n            \tthis.isVoice = this.isVoice?false:true;\n                if(!this.isVoice){\n                    this.jianpanicon = '../../static/image/icon_yysr.png'\n                }else{\n                    this.jianpanicon = '../../static/image/icon_sxsr.png'\n                }\n            },\n            // 发送文字消息\n            sendText(){\n            \tthis.hideDrawer();//隐藏抽屉\n            \tif(!this.textMsg){\n            \t\treturn;\n            \t}\n            \tlet content = this.textMsg;\n            \tlet msg = {text:content}\n            \tthis.sendMsg(msg,'text');\n            \tthis.textMsg = '';//清空输入框\n            },\n            //获取焦点，如果不是选表情ing,则关闭抽屉\n            textareaFocus(){\n                console.log('textareaFocus')\n            \tif(this.popupLayerClass=='showLayer' && this.hideMore == false){\n            \t\tthis.hideDrawer()\n            \t}\n                // this.sendText()\n            },\n            // 预览图片\n            showPic(msg){\n            \tuni.previewImage({\n            \t\tindicator:\"none\",\n            \t\tcurrent:msg.content.url,\n            \t\turls: this.msgImgList\n            \t});\n            },\n            // 添加语音消息到列表\n            addVoiceMsg(msg){\n            \tthis.msgList.push(msg);\n            },\n            // 添加文字消息到列表\n            addTextMsg(msg){\n            \tthis.msgList.push(msg);\n            },\n            // 添加图片消息到列表\n            addImgMsg(msg){\n            \tmsg.msg.content = this.setPicSize(msg.msg.content);\n            \tthis.msgImgList.push(msg.msg.content.url);\n            \tthis.msgList.push(msg);\n            },\n            // 发送消息\n            sendMsg(content,type){\n            \t//实际应用中，此处应该提交长连接，模板仅做本地处理。\n            \tvar nowDate = new Date();\n            \t// let lastid = this.msgList[this.msgList.length-1].msg.id;\n            \t// lastid++;\n                \n                // var accountinfo = uni.getStorageSync('accountinfo');\n                // var headUrl = JSON.parse(accountinfo.pics)[0].url\n            \t// let msg = {type:'user',msg:{id:lastid,time:nowDate.getHours()+\":\"+nowDate.getMinutes(),type:type,userinfo:{uid:0,username:accountinfo.name,face:headUrl},content:content}}\n            \t\n                var data \n                \n                if(type == 'text'){\n                    \n                    data = {\n                        fromId:this.userinfo.id,\n                        toId:this.userId,\n                        type:'txt',\n                        content:content.text,\n                        source:1\n                    }\n                }else if(type== 'img'){\n                          \n                    data = {\n                        fromId:this.userinfo.id,\n                        toId:this.userId,\n                        type:'img',\n                        content:'[图片]',\n                        url:content.url,\n                        source:1\n                    }\n                }else if(type== 'voice'){\n                    \n                    data = {\n                        fromId:this.userinfo.id,\n                        toId:this.userId,\n                        type:'audio',\n                        content:content.sec,\n                        url:content.url,\n                        source:1\n                    }\n                }\n                this.updateLastMsg()\n                var _self = this\n                api.managerSend({\n                    data: data\n                }).then(addRes => {\n                    console.log(addRes)\n                    if(addRes.status == 'OK'){\n                        // _self.messageList.unshift(addRes.data)\n                        setTimeout(function(){\n                            _self.updateLastMsg()\n                        },1000);\n                        \n                    }\n                    \n                })\n                \n            },\n            //选照片 or 拍照\n            getImage(type){\n            \tthis.hideDrawer();\n                var _self = this\n            \tuni.chooseImage({\n            \t\tsourceType:[type],\n            \t\tsizeType: ['original', 'compressed'], //可以指定是原图还是压缩图，默认二者都有\n            \t\tsuccess: (res)=>{\n            \t\t\tfor(let i=0;i<res.tempFilePaths.length;i++){\n            \t\t\t\tuni.getImageInfo({\n            \t\t\t\t\tsrc: res.tempFilePaths[i],\n            \t\t\t\t\tsuccess: (image)=>{\n            \t\t\t\t\t\t\n                                    if (_self.uploadParams) {\n                                    \tuni.showLoading({\n                                    \t\ttitle: '图片上传中'\n                                    \t})\n                                    \tuni.uploadFile({\n                                    \t\turl: _self.uploadParams.url,\n                                    \t\tfilePath: res.tempFilePaths[0],\n                                    \t\tname: 'userAvatar',\n                                    \t\tformData: {\n                                    \t\t\tpolicy: _self.uploadParams.policy,\n                                    \t\t\tSignature: _self.uploadParams.Signature\n                                    \t\t},\n                                    \t\tsuccess(result) {\n                                    \t\t\tif (result.data) {\n                                                    \n                                    \t\t\t\tlet r = JSON.parse(result.data)\n                                    \t\t\t\tif (r.status === 'OK') {\n                                    \t\t\t\t\tlet msg = {url:r.data.location + r.data.filepath};\n                                    \t\t\t\t\t_self.sendMsg(msg,'img');\n                                    \t\t\t\t} else {\n                                    \t\t\t\t\tuni.showToast({\n                                    \t\t\t\t\t\ttitle: r.message,\n                                    \t\t\t\t\t\ticon: \"none\",\n                                    \t\t\t\t\t\tduration: 2000\n                                    \t\t\t\t\t})\n                                    \t\t\t\t}\n                                    \t\t\t}\n                                    \t\t},\n                                    \t\tfail() {\n                                                    \n                                    \t\t},\n                                    \t\tcomplete(res) {\n                                    \t\t\tuni.hideLoading()\n                                    \t\t\tif (res.statusCode !== 200) {\n                                    \t\t\t\tuni.showToast({\n                                    \t\t\t\t\ttitle: res.errMsg,\n                                    \t\t\t\t\ticon: \"none\",\n                                    \t\t\t\t\tduration: 2000\n                                    \t\t\t\t})\n                                    \t\t\t}\n                                    \t\t}\n                                    \t})\n                                    } else {\n                                    \tuni.showToast({\n                                    \t\ttitle: 'getUploadParams failed!',\n                                    \t\ticon: \"none\",\n                                    \t\tduration: 2000\n                                    \t})\n                                    }\n                                    \n            \t\t\t\t\t\t\n            \t\t\t\t\t}\n            \t\t\t\t});\n            \t\t\t}\n            \t\t}\n            \t});\n            },\n            // 接受消息(筛选处理)\n            screenMsg(msg){\n            \t//从长连接处转发给这个方法，进行筛选处理\n            \tif(msg.type=='system'){\n            \t\t// 系统消息\n            \t\tswitch (msg.msg.type){\n            \t\t\tcase 'text':\n            \t\t\t\tthis.addSystemTextMsg(msg);\n            \t\t\t\tbreak;\n            \t\t\tcase 'redEnvelope':\n            \t\t\t\tthis.addSystemRedEnvelopeMsg(msg);\n            \t\t\t\tbreak;\n            \t\t}\n            \t}else if(msg.type=='user'){\n            \t\t// 用户消息\n            \t\tswitch (msg.msg.type){\n            \t\t\tcase 'text':\n            \t\t\t\tthis.addTextMsg(msg);\n            \t\t\t\tbreak;\n            \t\t\tcase 'voice':\n            \t\t\t\tthis.addVoiceMsg(msg);\n            \t\t\t\tbreak;\n            \t\t\tcase 'img':\n            \t\t\t\tthis.addImgMsg(msg);\n            \t\t\t\tbreak;\n            \t\t\tcase 'redEnvelope':\n            \t\t\t\tthis.addRedEnvelopeMsg(msg);\n            \t\t\t\tbreak;\n            \t\t}\n            \t\tconsole.log('用户消息');\n            \t\t//非自己的消息震动\n            \t\tif(msg.msg.userinfo.uid!=this.myuid){\n            \t\t\tconsole.log('振动');\n            \t\t\tuni.vibrateLong();\n            \t\t}\n            \t}\n            \tthis.$nextTick(function() {\n            \t\t// 滚动到底\n            \t\tthis.scrollToView = 'msg'+msg.msg.id\n            \t});\n            },\n            initMsgList(){\n                this.page = 1\n                this.msgList = []\n                this.getMsgList(null)\n            },\n            // 加载初始页面消息\n            getMsgList(Viewid){\n                \n                var data = {\n                    page:this.page,\n                    size:this.size,\n                    userId:this.userId,\n                }\n                let _self = this;\n                var list = []\n                var currentDate = ''\n                api.managerMsgPage({\n                    data: data\n                }).then(listRes => {\n\n                    if(listRes.status=='OK' && listRes.list.length>0 ){\n                        \n                        this.messageList = listRes.list\n                        \n                        var today = util.formatDate(new Date, 'yyyy-MM-dd')\n                        var tempDate\n                        var tempHhhh \n                        var tempMmmm = 0\n                        \n                        listRes.list.forEach((item,index)=>{\n                            \n                            var date = util.formatTimestamp(item.time, 'yyyy-MM-dd')\n                                                    \n                            var time = util.formatTimestamp(item.time,'hh:mm')\n                            \n                            if(!item.extJson){\n                                var message = {}\n                                message.type = 'user'\n                                message.msg = {}\n                                message.msg.id = item.id\n                                \n                                if(item.type=='txt'){       //文字类型\n                                    message.msg.type = \"text\"\n                                }else if(item.type=='img'){     //图片类型\n                                    message.msg.type = \"img\"\n                                }else if(item.type=='audio'){\n                                    message.msg.type = \"voice\"\n                                }\n                                \n                                message.msg.time = time\n                                message.msg.userinfo = {}\n                                if(item.fromId==this.userinfo.id){\n                                    //自己发的消息\n                                    message.msg.userinfo.uid = 0\n                                    message.msg.userinfo.username = this.userinfo.name\n                                    message.msg.userinfo.face = this.userinfo.icon\n                                }else{\n                                    //对方发的消息\n                                    message.msg.userinfo.uid = item.userId\n                                    message.msg.userinfo.username = item.displayName\n                                    message.msg.userinfo.face = item.displayAvatar\n                                }\n                                message.msg.content = {}\n                                if(item.type=='txt'){       //文字类型\n                                    message.msg.content.text = item.content\n                                }else if(item.type=='img'){     //图片类型\n                                    message.msg.content.url = item.url\n                                }else if(item.type=='audio'){\n                                    message.msg.content.url = item.url\n                                    message.msg.content.length = item.content\n                                }\n                                \n                                _self.msgList.unshift(message)\n                            }else{\n                                var message = {}\n                                //{type:\"system\",msg:{id:0,type:\"text\",content:{text:\"欢迎进入HM-chat聊天室\"}}},\n                      //           message.type = 'system'\n                      //           message.msg = {}\n                      //           message.msg.id = item.id\n                      //           message.msg.type = \"text\"\n                      //           message.msg.content = {}\n                      //           message.msg.content.text = item.content\n                      \n                      //           _self.msgList.unshift(message)\n                                \n                                var extContent = JSON.parse(item.extJson)\n                                var message = {}\n                                message.type = 'suggest'\n                                message.msg = {}\n                                message.msg.id = item.id\n                                message.msg.time = date + ' ' + time\n                                message.msg.content = {}\n                                message.msg.content.text = extContent.content\n                                message.msg.score = extContent.score\n                                _self.msgList.unshift(message)\n                            }\n                            \n                            if(today!=date ){     //日期不一样加时间消息\n                                if( tempDate != date){\n                                    var message = {}\n                                    message = {type:\"system\",msg:{id:0,type:\"text\",content:{text:date+' '+time}}}\n                                    _self.msgList.unshift(message)\n                                    tempDate = date\n                                }\n                                \n                            }else{          //今天\n                                var message = {}\n                                var hhhhh = util.formatTimestamp(item.time,'hh')\n                                var mmmm = util.formatTimestamp(item.time,'mm')\n                                if(tempHhhh!=hhhhh){        //不同小时\n                                    message = {type:\"system\",msg:{id:0,type:\"text\",content:{text:hhhhh+':'+mmmm}}}\n                                    _self.msgList.unshift(message)\n                                    tempHhhh = hhhhh\n                                }else{      //同一个小时\n                                    \n                                    if(mmmm - tempMmmm <-2 ){\n                                        message = {type:\"system\",msg:{id:0,type:\"text\",content:{text:hhhhh+':'+mmmm}}}\n                                        _self.msgList.unshift(message)\n                                    }\n                                    tempMmmm = mmmm\n                                }\n                                \n                            }\n                            \n                        })\n                        for(let i=0;i<_self.msgList.length;i++){\n                        \tif(_self.msgList[i].type=='user'&&_self.msgList[i].msg.type==\"img\"){\n                        \t\t_self.msgList[i].msg.content = _self.setPicSize(_self.msgList[i].msg.content);\n                        \t\t_self.msgImgList.push(_self.msgList[i].msg.content.url);\n                        \t}\n                        }\n                        \n                        \n                        // 滚动到底部\n                      \n                        _self.$nextTick(function() {\n                        \t//进入页面滚动到底部\n                        \t_self.scrollTop = 9999;\n                        \t_self.$nextTick(function() {\n                        \t\t_self.scrollAnimation = true;\n                        \t});\n                        \t\n                        });\n                        if(Viewid != null){\n                            //这段代码很重要，不然每次加载历史数据都会跳到顶部\n                            _self.$nextTick(function() {\n                            \t_self.scrollToView = 'msg'+Viewid;//跳转上次的第一行信息位置\n                            \t_self.$nextTick(function() {\n                            \t\t_self.scrollAnimation = true;//恢复滚动动画\n                            \t});\n                            \t\n                            });\n                            \n                        }\n                        \n                    }\n                    _self.isHistoryLoading = false;\n                })\n            },\n            //处理图片尺寸，如果不处理宽高，新进入页面加载图片时候会闪\n            setPicSize(content){\n            \t// 让图片最长边等于设置的最大长度，短边等比例缩小，图片控件真实改变，区别于aspectFit方式。\n            \tlet maxW = uni.upx2px(350);//350是定义消息图片最大宽度\n            \tlet maxH = uni.upx2px(350);//350是定义消息图片最大高度\n            \tif(content.w>maxW||content.h>maxH){\n            \t\tlet scale = content.w/content.h;\n            \t\tcontent.w = scale>1?maxW:maxH*scale;\n            \t\tcontent.h = scale>1?maxW/scale:maxH;\n            \t}\n            \treturn content;\n            },\n            //触发滑动到顶部(加载历史信息记录)\n            loadHistory(e){\n            \tif(this.isHistoryLoading){\n            \t\treturn ;\n            \t}\n                this.page++\n                \n                \n            \tthis.isHistoryLoading = true;//参数作为进入请求标识，防止重复请求\n            \tthis.scrollAnimation = false;//关闭滑动动画\n            \tvar Viewid = this.msgList[0].msg.id;//记住第一个信息ID\n                \n                this.getMsgList(Viewid)\n            },\n            // 录音开始\n            voiceBegin(e){\n                console.log('voiceBegin')\n            \tif(e.touches.length>1){\n            \t\treturn ;\n            \t}\n                this.recording = true;\n            \tthis.initPoint.Y = e.touches[0].clientY;\n            \tthis.initPoint.identifier = e.touches[0].identifier;\n            \tthis.RECORDER.start({format:\"mp3\"});//录音开始,\n            },\n            // 播放语音\n            playVoice(msg){\n            \tthis.playMsgid=msg.id;\n            \tthis.AUDIO.src = msg.content.url;\n            \tthis.$nextTick(function() {\n            \t\tthis.AUDIO.play();\n            \t});\n            },\n            //录音开始UI效果\n            recordBegin(e){\n            \tif(!this.recording){\n            \t\treturn;\n            \t}\n            \tthis.voiceTis='松开 结束';\n            \tthis.recordLength = 0;\n            \tthis.recordTimer = setInterval(()=>{\n            \t\tthis.recordLength++;\n            \t},1000)\n            },\n            // 录音被打断\n            voiceCancel(){\n                console.log('voiceCancel')\n            \tthis.recording = false;\n            \tthis.voiceTis='按住 说话';\n            \tthis.recordTis = '手指上滑 取消发送'\n            \tthis.willStop = true;//不发送录音\n            \tthis.RECORDER.stop();//录音结束\n            },\n            // 录音中(判断是否触发上滑取消发送)\n            voiceIng(e){\n                console.log('voiceIng')\n            \tif(!this.recording){\n            \t\treturn;\n            \t}\n            \tlet touche = e.touches[0];\n            \t//上滑一个导航栏的高度触发上滑取消发送\n            \tif(this.initPoint.Y - touche.clientY>=uni.upx2px(100)){\n            \t\tthis.willStop = true;\n            \t\tthis.recordTis = '松开手指 取消发送'\n            \t}else{\n            \t\tthis.willStop = false;\n            \t\tthis.recordTis = '手指上滑 取消发送'\n            \t}\n            },\n            // 结束录音\n            voiceEnd(e){\n                console.log('voiceEnd：'+this.recording)\n            \tif(!this.recording){\n            \t\treturn;\n            \t}\n                \n            \tthis.recording = false;\n            \tthis.voiceTis='按住 说话';\n            \tthis.recordTis = '手指上滑 取消发送'\n            \tthis.RECORDER.stop();//录音结束\n                console.log('recordTis')\n            },\n            //录音结束(回调文件)\n            recordEnd(e){\n            \tclearInterval(this.recordTimer);\n            \tif(!this.willStop){\n            \t\tconsole.log(\"e: \" + JSON.stringify(e));\n            \t\tlet msg = {\n            \t\t\tlength:0,\n            \t\t\turl:e.tempFilePath\n            \t\t}\n            \t\tlet min = parseInt(this.recordLength/60);\n            \t\tlet sec = this.recordLength%60;\n            \t\tmin = min<10?'0'+min:min;\n            \t\tsec = sec<10?'0'+sec:sec;\n                    \n                    if(sec<2){\n                        uni.showToast({\n                            title: '录音时间太短',\n                            icon: \"none\",\n                            duration: 2000\n                        })\n                        return\n                    }\n                    \n            \t\tmsg.length = min+':'+sec;\n                    \n                    uni.showLoading({\n                    \ttitle: '语音发送中'\n                    })\n                    var _self = this\n                    var uploadTask = uni.uploadFile({\n                    \turl: _self.uploadParams.url,\n                    \tfilePath: e.tempFilePath,\n                    \tname: 'userAvatar',\n                    \tformData: {\n                    \t\tpolicy: _self.uploadParams.policy,\n                    \t\tSignature: _self.uploadParams.Signature\n                    \t},\n                    \tsuccess(result) {\n                    \t\tif (result.data) {\n                                console.log(result.data);\n                    \t\t\tlet r = JSON.parse(result.data)\n                    \t\t\tif (r.status === 'OK') {\n                    \t\t\t\tlet msg = {url:r.data.location + r.data.filepath,sec:sec};\n                    \t\t\t\t_self.sendMsg(msg,'voice');\n                    \t\t\t} else {\n                    \t\t\t\tuni.showToast({\n                    \t\t\t\t\ttitle: r.message,\n                    \t\t\t\t\ticon: \"none\",\n                    \t\t\t\t\tduration: 2000\n                    \t\t\t\t})\n                    \t\t\t}\n                    \t\t}\n                    \t},\n                    \tfail() {\n                                \n                    \t},\n                    \tcomplete(res) {\n                    \t\tuni.hideLoading()\n                    \t\tif (res.statusCode !== 200) {\n                    \t\t\tuni.showToast({\n                    \t\t\t\ttitle: res.errMsg,\n                    \t\t\t\ticon: \"none\",\n                    \t\t\t\tduration: 2000\n                    \t\t\t})\n                    \t\t}\n                    \t}\n                    })\n                    \n                    \n                    \n            \t\t// this.sendMsg(msg,'voice');\n            \t}else{\n            \t\tconsole.log('取消发送录音');\n            \t}\n            \tthis.willStop = false;\n            },\n            //更多功能(点击+弹出)\n            showMore(){\n            \tthis.isVoice = false;\n            \tthis.hideEmoji = true;\n            \tif(this.hideMore){\n            \t\tthis.hideMore = false;\n            \t\tthis.openDrawer();\n            \t}else{\n            \t\tthis.hideDrawer();\n            \t}\n            },\n            // 打开抽屉\n            openDrawer(){\n            \tthis.popupLayerClass = 'showLayer';\n            },\n            // 隐藏抽屉\n            hideDrawer(){\n            \tthis.popupLayerClass = '';\n            \tsetTimeout(()=>{\n            \t\tthis.hideMore = true;\n            \t\tthis.hideEmoji = true;\n            \t},150);\n            },\n            discard(){\n            \treturn;\n            }\n    \t}\n    }\n</script>\n\n<style lang=\"scss\">\r\n\t@import \"@/static/HM-chat/css/style.scss\"; \n    .suggest-box{\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    .suggest{\n        width:502upx;\n        // height:356upx;\n        background:rgba(255,255,255,1);\n        border-radius:30upx;\n        padding: 30upx;\n    }\n    .suggest-title{\n        display: flex;\n        align-items: center;\n        font-size:32upx;\n        font-family:PingFangSC-Medium,PingFang SC;\n        font-weight:500;\n        color:rgba(22,32,46,1);\n        line-height:44upx;\n        height: 100upx;\n    }\n    .suggest-des{\n        font-size:26upx;\n        font-family:PingFangSC-Regular,PingFang SC;\n        font-weight:400;\n        color:rgba(67,78,94,1);\n        line-height:40upx;\n    }\n    .suggest-btn{\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        justify-content: space-between;\n        font-size:28upx;\n        font-family:PingFangSC-Regular,PingFang SC;\n        font-weight:400;\n        color:#03BE90;\n        line-height:40upx;\n    }\n    .suggest-btn image{\n        height: 26upx;\n        width: 16upx;\n    }\n    .suggest-xing{\n        display: flex;\n        align-items: center;\n        height: 100upx;\n        font-size:24upx;\n        font-family:PingFangSC-Regular,PingFang SC;\n        font-weight:400;\n        color:rgba(162,169,186,1);\n        line-height:34upx;\n    }\n    .suggest-xing image{\n        width: 32upx;\n        height: 30upx;\n    }\n    .suggest-input{\n        position: fixed;\n        bottom: 0upx;\n        min-height: 100upx;\n        width: 100%;\n        font-size:32upx;\n        font-family:PingFangSC-Regular,PingFang SC;\n        font-weight:400;\n        color:rgba(255,255,255,1);\n        line-height:44upx;\n        background:linear-gradient(315deg,rgba(136,226,150,1) 0%,rgba(3,190,144,1) 100%);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    .picbox{\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        justify-content: center;\n        margin-left: 14upx;\n        margin-right: 14upx;\n    }\n    .picbox .img{\n        width: 56upx;\n        height: 56upx;\n    }\n\n    .suggest-btn-pic{\n        width: 40upx;\n        height: 40upx;\n        \n    }\n    .suggest-btn-text{\n        font-size:24upx;\n        font-family:PingFangSC-Regular,PingFang SC;\n        font-weight:400;\n        color:rgba(255,255,255,1);\n        line-height:34upx;\n    }\n    .suggest-btn-box{\n        position: fixed;\n        bottom: 130upx;\n        right: 30upx;\n        z-index: 99;\n        width:120upx;\n        height:120upx;\n        background:linear-gradient(233deg,rgba(136,226,150,1) 0%,rgba(3,190,144,1) 100%);\n        box-shadow:0px 6upx 30upx 0px rgba(3,190,144,0.3);\n        border-radius: 60upx;\n        \n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n    }\n    .report-box{\n        position: fixed;\n        bottom: 280upx;\n        right: 30upx;\n        z-index: 99;\n        width:120upx;\n        height:120upx;\n        background:#FFFFFF;\n        box-shadow:0px 6upx 30upx 0px #868E9D;\n        border-radius: 60upx;\n        \n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        \n        font-size:24upx;\n        font-family:PingFangSC-Regular,PingFang SC;\n        font-weight:400;\n        color:rgba(3,190,144,1);\n    }\n    .input-placeholder{\n        font-size:28upx;\n        font-family:PingFangSC-Regular,PingFang SC;\n        font-weight:400;\n        color:rgba(198,202,212,1);\n    }\n    .reportbottom{\n        bottom: 130upx;\n    }\n</style>\n","import mod from \"-!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./consultDetails.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./consultDetails.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}